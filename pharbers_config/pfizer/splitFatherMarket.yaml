name: father market
reference: com.pharbers.ipaas.data.driver.job.PhBaseJob
factory: com.pharbers.ipaas.data.driver.factory.PhJobFactory
actions:
  - name: product_match_file
    reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
    factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
    args:
      null: null
    opers:
      - name: read
        reference: com.pharbers.ipaas.data.driver.job.PhReadOperator
        factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
        args:
          path:
  - name: pfc_match_file
      reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
      factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
      args:
        null: null
      opers:
        - name: read
          reference: com.pharbers.ipaas.data.driver.job.PhReadOperator
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          args:
            path:
        - name: filter market
            factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
            reference: com.pharbers.ipaas.data.driver.job.PhFilterOperator
            args:
              inDFName: df
              filter: MARKET like 'AI_D' OR MARLET like 'ZYVOX'
  - name: spilt_markets_product_match
      reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
      factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
      args:
        df: product_match_file
      opers:
        - name: select
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.operators.select
          args:
            inDFName: df
            selects: MIN_PRODUCT_UNIT#MIN_PRODUCT_UNIT_STANDARD#MOLE_NAME#PACK_ID as PACK_ID_P
        - name: distinct
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.operators.DistinctOperator
          args:
            inDFName: df
        - name: join
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.operators.JoinOperator
          args:
            inDFName: df
            joinDFName: pfc_match_file
            joinExpr: PACK_ID_P == PACK_ID
            joinType: left
        - name: filter
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.job.PhFilterOperator
          args:
            inDFName: df
            filter: PACK_ID is null
        - name: select
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.operators.select
          args:
            inDFName: df
            selects: MIN_PRODUCT_UNIT#MIN_PRODUCT_UNIT_STANDARD
        - name: distinct
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.operators.DistinctOperator
          args:
            inDFName: df
