#pools:
#- name: PhMongodbPool
#  args: &PhMongodbPool
#    host: 123.56.179.133
#    port: 5555
#    database: pharbers-max-repository
#    username: abc
#    password: abc
#- name: PhRedisPool
#  args: &PhRedisPool
#    host: 123.56.179.133
#    port: 6378
#    database: pharbers-max
#    password: abc

#plugins:
#- name: CalcYTD
#  args: &CalcYTDPlugin
#    jar: ~/workspare/**.jar
#    class: com.pharbers.ipass.data.driver.operators.CalcYTD
#
#operators:
#- name: CalcYTD
#  args: &CalcYTD
#    class: com.pharbers.ipass.data.driver.operators.CalcYTD
#- name: CalcMTD
#  args: &CalcMTD
#    class: com.pharbers.ipass.data.driver.operators.CalcMTD

name: test
reference: com.pharbers.ipaas.data.driver.job.PhBaseJob
factory: com.pharbers.ipaas.data.driver.factory.PhJobFactory
actions:
    - name: readCpaFile
      reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
      factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
      args:
        null: null
      opers:
        - name:
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.job.PhReadOperator
          args:
            path: hdfs:///data/nhwa/pha_config_repository1809/Nhwa_201809_CPA_20181126.csv
    - name: readHospitalFile
      reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
      factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
      args:
        null: null
      opers:
        - name:
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.job.PhReadOperator
          args:
            path: hdfs:///repository/hosp_dis_max

    - name: sales*Factor
      reference: com.pharbers.ipaas.data.driver.job.PhBaseAction
      factory: com.pharbers.ipaas.data.driver.factory.PhActionFactory
      args:
        df: read
      opers:
        - name:
          factory: com.pharbers.ipaas.data.driver.factory.PhOperatorFactory
          reference: com.pharbers.ipaas.data.driver.job.PhBaseOperator
          args:
            newColumnName: new
            exprString: f_sales * Factor
          plugin:
            name: baseCalc
            reference: com.pharbers.ipaas.data.driver.plugin.BaseCalcPlugin
            factory: com.pharbers.ipaas.data.driver.factory.PhPluginFactory
